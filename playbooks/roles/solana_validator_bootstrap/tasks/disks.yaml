# ledger

- name: Create ledger path
  become: true
  ansible.builtin.file:
    path: "{{ ledger_disk.path }}"
    state: directory
  when: ledger_disk.managed

- name: Create a ext4 filesystem for ledger
  community.general.parted:
    device: "/dev/{{ ledger_disk.device }}"
    number: 1
    state: present
    label: gpt
    fs_type: ext4
  when: ledger_disk.managed

#- name: Create a ext4 filesystem for ledger
#  become: true
#  filesystem:
#    fstype: ext4
#    dev: "/dev/{{ ledger_disk.device }}"
#    opts: -cc
#  when: ledger_disk.managed

- name: mount ledger disk
  become: true
  mount:
    src: "/dev/{{ ledger_disk.device }}p1"
    path: "{{ ledger_disk.path }}"
    fstype: ext4
    opts: defaults
    state: mounted
    passno: 1
  when: ledger_disk.managed

# accounts

- name: Create accounts path
  become: true
  ansible.builtin.file:
    path: "{{ accounts_disk.path }}"
    state: directory
  when: accounts_disk.managed

- name: Create a ext4 filesystem for accounts
  become: true
  filesystem:
    fstype: ext4
    dev: "/dev/{{ accounts_disk.device }}"
  when: accounts_disk.managed

#- name: Create a ext4 filesystem for accounts
#  community.general.parted:
#    device: "/dev/{{ accounts_disk.device }}"
#    number: 1
#    state: present
#    label: gpt
#    fs_type: ext4
#  when: accounts_disk.managed

- name: mount accounts disk
  become: true
  mount:
    src: "/dev/{{ accounts_disk.device }}p1"
    path: "{{ accounts_disk.path }}"
    fstype: ext4
    opts: defaults
    state: mounted
    passno: 1
  when: accounts_disk.managed

# snapshots

- name: Create snapshots path
  become: true
  ansible.builtin.file:
    path: "{{ snapshots_disk.path }}"
    state: directory
  when: snapshots_disk.managed

- name: Create a ext4 filesystem for snapshots
  become: true
  filesystem:
    fstype: ext4
    dev: "/dev/{{ snapshots_disk.device }}"
  when: snapshots_disk.managed

#- name: Create a ext4 filesystem for snapshots
#  community.general.parted:
#    device: "/dev/{{ snapshots_disk.device }}"
#    number: 1
#    state: present
#    label: gpt
#    fs_type: ext4
#  when: snapshots_disk.managed

- name: mount snapshots disk
  become: true
  mount:
    src: "/dev/{{ snapshots_disk.device }}p1"
    path: "{{ snapshots_disk.path }}"
    fstype: ext4
    opts: defaults
    state: mounted
    passno: 1
  when: snapshots_disk.managed